version: '2'
services:
  mongo-rep1:
    image: "mongo:${version}"
    labels:
        com.datadoghq.sd.check.id: "mongo-dummydata"
    command:
      - mongod
      - --replSet
      - "rs0"

  mongo-rep2:
    image: "mongo:${version}"
    labels:
        com.datadoghq.sd.check.id: "mongo-dummydata"
    command:
      - mongod
      - --replSet
      - "rs0"

  mongo-rep3:
    depends_on:
      - mongo-rep1
      - mongo-rep2
    image: "mongo:${version}"
    labels:
        com.datadoghq.sd.check.id: "mongo-dummydata"
    volumes:
      - ./provision/restaurants.json:/docker-entrypoint-initdb.d/restaurants.json:ro
      - ./provision/replica_set.sh:/docker-entrypoint-initdb.d/00_replica_set.sh:ro
      - ./provision/import_dummy_data.sh:/docker-entrypoint-initdb.d/10_import_dummy_data.sh:ro
    command:
      - mongod
      - --replSet
      - "rs0"
